// ---------------------------------------------------------------------------------------------------------------------------------
//   ___ _ __ _ __  ___  _ __
//  / _ \ '__| '__|/ _ \| '__|
// |  __/ |  | |  | (_) | |
//  \___|_|  |_|   \___/|_|
//
// Description:
//
//   Cascading error management
//
// Notes:
//
//   Best viewed with 8-character tabs and (at least) 132 columns
//
// History:
//
//   04/22/2001 by Paul Nettle: Original creation
//
// ---------------------------------------------------------------------------------------------------------------------------------
// Originally released under a custom license.
// This historical re-release is provided under the MIT License.
// See the LICENSE file in the repo root for details.
//
// https://github.com/nettlep
//
// Copyright 2002, Fluid Studios, all rights reserved.
// ---------------------------------------------------------------------------------------------------------------------------------

#ifndef	_FSTL_ERROR
#define _FSTL_ERROR

// ---------------------------------------------------------------------------------------------------------------------------------
// Module setup (required includes, macros, etc.)
// ---------------------------------------------------------------------------------------------------------------------------------

#include "common"
#include "string"
#include "array"

FSTL_NAMESPACE_BEGIN

// ---------------------------------------------------------------------------------------------------------------------------------

template <class T = string>
class	basic_error
{
public:
	// Construction/Destruction

inline				basic_error() {}

inline				basic_error(const T & location, const T & instruction, const T & message)
				{
					locations() += location;
					instructions() += instruction;
					messages() += message;
				}

inline				basic_error(const basic_error & rhs)
				{
					*this = rhs;
				}

inline				~basic_error() {}

	// Operators
	
inline		basic_error &	operator=(const basic_error & rhs)
				{
					if (this == &rhs) return *this;
					locations() = rhs.locations();
					instructions() = rhs.instructions();
					messages() = rhs.messages();
					return *this;
				}

inline		basic_error	operator+(const T & rhs) const
				{
					basic_error	result(*this);
					result.locations() += rhs.findWord(0);
					result.instructions() += rhs.findWord(1);
					result.messages() += rhs.findWord(2);
					return result;
				}

inline		basic_error &	operator+=(const T & rhs)
				{
					locations() += rhs.findWord(0);
					instructions() += rhs.findWord(1);
					messages() += rhs.findWord(2);
					return *this;
				}

inline		basic_error	operator+(const basic_error & rhs) const
				{
					basic_error	result(*this);
					result.locations() += rhs.locations();
					result.instructions() += rhs.locations();
					result.messages() += rhs.messages();
					return result;
				}

inline		basic_error &	operator+=(const basic_error & rhs)
				{
					locations() += rhs.locations();
					instructions() += rhs.locations();
					messages() += rhs.messages();
					return *this;
				}

	// Implementation

	// Accessors
	
inline		array<T> &	locations()          {return _locations;}
inline	const	array<T> &	locations() const    {return _locations;}
inline		array<T> &	instructions()       {return _instructions;}
inline	const	array<T> &	instructions() const {return _instructions;}
inline		array<T> &	messages()           {return _messages;}
inline	const	array<T> &	messages() const     {return _messages;}

private:
	// Data members
	
		array<T>	_locations;
		array<T>	_instructions;
		array<T>	_messages;
};

typedef	basic_error<string>	error;
typedef	basic_error<wstring>	werror;

FSTL_NAMESPACE_END
#endif // _FSTL_ERROR
// ---------------------------------------------------------------------------------------------------------------------------------
// error - End of file
// ---------------------------------------------------------------------------------------------------------------------------------

